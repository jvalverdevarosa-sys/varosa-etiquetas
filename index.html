<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etiqueta VAROSA - Optimizada para SATO</title>
    <style>
        /* ============================================
           CONFIGURACI√ìN CR√çTICA PARA IMPRESI√ìN T√âRMICA
           Tama√±o: 101.6mm x 50.8mm (4" x 2")
           ============================================ */
        
        /* Configuraci√≥n de p√°gina - TAMA√ëO EXACTO */
        @page {
            size: 101.6mm 50.8mm;  /* Ancho x Alto exactos */
            margin: 0 !important;  /* Sin m√°rgenes de p√°gina */
        }
        
        /* Reset completo */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Forzar impresi√≥n de colores y fondos */
        * {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            color-adjust: exact !important;
        }
        
        html, body {
            width: 101.6mm;
            height: 50.8mm;
            margin: 0 !important;
            padding: 0 !important;
            overflow: hidden;
        }
        
        /* ============================================
           ESTILOS DE PANTALLA (para previsualizaci√≥n)
           ============================================ */
        @media screen {
            body {
                background: #f0f0f0;
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                padding: 20px;
            }
            
            .etiqueta-container {
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            }
            
            .controles {
                position: fixed;
                top: 20px;
                left: 20px;
                background: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                z-index: 1000;
            }
            
            .controles button {
                background: #2563eb;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                margin: 5px;
            }
            
            .controles button:hover {
                background: #1d4ed8;
            }
            
            .info-config {
                position: fixed;
                bottom: 20px;
                left: 20px;
                background: #fef3c7;
                padding: 15px;
                border-radius: 8px;
                border-left: 4px solid #f59e0b;
                max-width: 400px;
                font-size: 12px;
            }
        }
        
        /* ============================================
           ESTILOS DE IMPRESI√ìN
           ============================================ */
        @media print {
            html, body {
                width: 101.6mm !important;
                height: 50.8mm !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            .controles, .info-config {
                display: none !important;
            }
            
            .etiqueta-container {
                box-shadow: none !important;
            }
        }
        
        /* ============================================
           DISE√ëO DE LA ETIQUETA
           ============================================ */
        .etiqueta-container {
            width: 101.6mm;
            height: 50.8mm;
            background: white;
            display: grid;
            grid-template-columns: 1fr auto;
            grid-template-rows: auto 1fr auto;
            padding: 2mm;
            font-family: Arial, Helvetica, sans-serif;
            overflow: hidden;
        }
        
        /* Header - OV y Ruta */
        .header {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 0.5mm solid #000;
            padding-bottom: 1.5mm;
            margin-bottom: 1mm;
        }
        
        .ov-numero {
            font-size: 5mm;
            font-weight: bold;
            letter-spacing: 0.3mm;
        }
        
        .ruta {
            font-size: 3.5mm;
            font-weight: bold;
            background: #000;
            color: #fff;
            padding: 0.8mm 2mm;
            border-radius: 1mm;
            max-width: 35mm;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Contenido principal */
        .contenido {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding-right: 2mm;
            overflow: hidden;
        }
        
        .cliente {
            font-size: 3.8mm;
            font-weight: bold;
            line-height: 1.2;
            max-height: 12mm;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .info-secundaria {
            display: flex;
            gap: 3mm;
            font-size: 3mm;
            margin-top: 1mm;
        }
        
        .bulto {
            font-weight: bold;
            background: #e5e7eb;
            padding: 0.5mm 1.5mm;
            border-radius: 0.5mm;
        }
        
        .alistador {
            color: #374151;
        }
        
        .notas {
            font-size: 3.2mm;
            font-weight: bold;
            color: #dc2626;
            background: #fef2f2;
            padding: 1mm 1.5mm;
            border-radius: 0.5mm;
            border: 0.3mm solid #fecaca;
            margin-top: 1mm;
            max-height: 8mm;
            overflow: hidden;
        }
        
        /* QR Code */
        .qr-section {
            grid-row: 2 / 4;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-left: 2mm;
            border-left: 0.3mm dashed #9ca3af;
        }
        
        .qr-code {
            width: 22mm;
            height: 22mm;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .qr-code svg, .qr-code img {
            width: 100%;
            height: 100%;
        }
        
        /* Footer */
        .footer {
            grid-column: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 2.5mm;
            color: #6b7280;
            padding-top: 1mm;
            border-top: 0.3mm solid #e5e7eb;
            margin-top: 1mm;
        }
        
        .fecha {
            font-weight: 500;
        }
        
        .logo-varosa {
            font-weight: bold;
            font-size: 2.8mm;
            color: #1f2937;
        }
    </style>
    
    <!-- Librer√≠a QR Code -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
    
    <!-- Controles (solo visible en pantalla) -->
    <div class="controles">
        <h3 style="margin-bottom: 10px; font-size: 14px;">üè∑Ô∏è Etiqueta VAROSA</h3>
        <button onclick="window.print()">üñ®Ô∏è Imprimir</button>
        <button onclick="cargarDatosDemo()">üìã Datos Demo</button>
        <p style="margin-top: 10px; font-size: 11px; color: #666;">
            Tama√±o: 101.6mm √ó 50.8mm
        </p>
    </div>
    
    <!-- Info de configuraci√≥n -->
    <div class="info-config">
        <strong>‚öôÔ∏è Configuraci√≥n del navegador al imprimir:</strong>
        <ul style="margin-top: 8px; padding-left: 15px;">
            <li>M√°rgenes: <strong>Ninguno</strong></li>
            <li>Tama√±o de papel: <strong>101.6mm √ó 50.8mm</strong> (crear tama√±o personalizado)</li>
            <li>Orientaci√≥n: <strong>Horizontal</strong></li>
            <li>Encabezados/Pies: <strong>Desactivados</strong></li>
            <li>Escala: <strong>100%</strong></li>
        </ul>
    </div>
    
    <!-- ETIQUETA -->
    <div class="etiqueta-container">
        <!-- Header -->
        <div class="header">
            <span class="ov-numero" id="ovNumero">SO-08165</span>
            <span class="ruta" id="ruta">CIUDAD QUESADA</span>
        </div>
        
        <!-- Contenido principal -->
        <div class="contenido">
            <div class="cliente" id="cliente">JUNTA ADMINISTRATIVA COLEGIO T√âCNICO PROFESIONAL DE PITAL</div>
            
            <div class="info-secundaria">
                <span class="bulto" id="bulto">üì¶ 1 de 2</span>
                <span class="alistador" id="alistador">üë§ Juan P√©rez</span>
            </div>
            
            <div class="notas" id="notas">‚ö†Ô∏è NO FACTURAR - ENTREGA PARCIAL</div>
        </div>
        
        <!-- QR Code -->
        <div class="qr-section">
            <div class="qr-code" id="qrcode"></div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <span class="fecha" id="fecha">09/12/2025 14:30</span>
            <span class="logo-varosa">VAROSA</span>
        </div>
    </div>
    
    <script>
        // Datos de ejemplo
        const datosDemo = {
            ov: "SO-08165",
            cliente: "JUNTA ADMINISTRATIVA COLEGIO T√âCNICO PROFESIONAL DE PITAL",
            ruta: "CIUDAD QUESADA",
            bultoActual: 1,
            bultoTotal: 2,
            alistador: "Juan P√©rez",
            notas: "NO FACTURAR - ENTREGA PARCIAL",
            fecha: new Date().toLocaleString('es-CR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            })
        };
        
        // Generar QR
        function generarQR(datos) {
            const qrContainer = document.getElementById('qrcode');
            qrContainer.innerHTML = '';
            
            const qrData = JSON.stringify({
                ov: datos.ov,
                cliente: datos.cliente.substring(0, 50),
                ruta: datos.ruta,
                bulto: `${datos.bultoActual}/${datos.bultoTotal}`
            });
            
            new QRCode(qrContainer, {
                text: qrData,
                width: 80,
                height: 80,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.M
            });
        }
        
        // Cargar datos en la etiqueta
        function cargarDatos(datos) {
            document.getElementById('ovNumero').textContent = datos.ov;
            document.getElementById('cliente').textContent = datos.cliente;
            document.getElementById('ruta').textContent = datos.ruta;
            document.getElementById('bulto').textContent = `üì¶ ${datos.bultoActual} de ${datos.bultoTotal}`;
            document.getElementById('alistador').textContent = `üë§ ${datos.alistador}`;
            document.getElementById('notas').textContent = datos.notas ? `‚ö†Ô∏è ${datos.notas}` : '';
            document.getElementById('fecha').textContent = datos.fecha;
            
            // Ocultar notas si est√° vac√≠o
            document.getElementById('notas').style.display = datos.notas ? 'block' : 'none';
            
            generarQR(datos);
        }
        
        function cargarDatosDemo() {
            cargarDatos(datosDemo);
        }
        
        // Cargar datos desde URL params
        function cargarDatosDesdeURL() {
            const params = new URLSearchParams(window.location.search);
            
            if (params.has('ov')) {
                const datos = {
                    ov: params.get('ov') || datosDemo.ov,
                    cliente: params.get('cliente') || datosDemo.cliente,
                    ruta: params.get('ruta') || datosDemo.ruta,
                    bultoActual: parseInt(params.get('bultoActual')) || datosDemo.bultoActual,
                    bultoTotal: parseInt(params.get('bultoTotal')) || datosDemo.bultoTotal,
                    alistador: params.get('alistador') || datosDemo.alistador,
                    notas: params.get('notas') || '',
                    fecha: params.get('fecha') || datosDemo.fecha
                };
                cargarDatos(datos);
            } else {
                cargarDatos(datosDemo);
            }
        }
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', cargarDatosDesdeURL);
    </script>
</body>
</html>
